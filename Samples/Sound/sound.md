# 音の再生

## Sound クラス
音ファイルから生成された音の情報を定義します。このクラスは音の情報を格納しているだけであり、実際に音声を再生するにはこれを`SoundMixer`に渡す必要があります。

音ファイルからこのクラスのインスタンスを生成するには`Load`メソッドを使います。クラスのインスタンスを生成するに際し、事前に音データを解凍するかどうかを指定できます。OGG等のフォーマットでは、音データが圧縮された状態で格納されており、音を再生するときは圧縮されたデータを解凍しなければなりません。ここでは、事前にファイルを解凍するか再生中にリアルタイムに解凍するかを指定できます。

このクラスでは音のループポイントを設定できます。音をループさせるには`IsLoopingMode`を`true`にします。ループポイントを設定していない場合、音を最後まで再生したら最初に戻ってループします。`LoopStartingPoint`及び`LoopEndPoint`を設定すると、先頭から音を再生し、`LoopEndPoint`に到達したら`LoopStartPoint`の位置に戻って再開します。

![loop](loop.png)

> [!TIP]
> 音のデータをを事前に解凍するか、再生中にリアルタイムに解凍するかによって、消費するメモリやCPUへの負荷が異なります。
> 事前に解凍する場合、読み込み時間は長くなりメモリも消費しますが再生時のCPUへの負荷は小さくなります。
> 一方、再生中にリアルタイムに解凍する場合は、読み込み時間もメモリも小さくなりますが、再生時に若干CPUの処理を必要とします。
> 基本的に、音が長いBGMは圧縮したまま、音が短くたくさん鳴らす効果音は事前に解凍して読み込みます。

### メソッド一覧

|名称|説明|
|--|--|
|`Load`|音データをファイルから作成します。|

### プロパティ一覧

|名称|アクセサ|説明|
|--|--|--|
|`LoopStartingPoint`|`get`/`set`|ループ開始地点(秒)を取得/設定します。|
|`LoopEndPoint`|`get`/`set`|ループ終了地点(秒)を取得/設定します。|
|`IsLoopingMode`|`get`/`set`|ループするかどうかを取得/設定します。|
|`Length`|`get`|音源の長さ(秒)を取得します。|

## SoundMixer クラス
音の再生・停止・その他操作を行う機能を提供します。音を再生する場合は必ず使用する必要があります。

音を再生するには`Play`メソッドを使用します。このメソッドを実行すると、再生される音に対応するIDが発行されます。`SoundMixer`クラスの各メソッドにこのIDを渡すと、再生されている音に対して操作をすることができます。

> [!TIP]
> Altseedでは、再生されている音に対する操作をIDを通して行っています。これは、音のデータそのものとは別に、音の再生情報に関するデータを管理するためです。
> 音のデータが再生情報を含んでいる場合、同じ音を二重に再生することができません。
> BGMなどを除き、再生中に停止などの操作を行うことは稀です。そのため再生の度に、再生情報を含むインスタンスを生成することは無駄が大きいため、都度IDを用いて操作する仕組みになっています。

### メソッド一覧

|名称|説明|
|--|--|
|`Play`|音を再生します。|
|`GetIsPlaying`|IDに対応した音が再生中であるかを取得します。|
|`StopAll`|再生中の全ての音を停止します。|
|`Stop`|IDに対応した音の再生を停止します。|
|`Pause`|IDに対応した音の再生を一時停止します。|
|`Resume`|IDに対応した音の再生を再開します。|
|`SetVolume`|IDに対応した音の音量を変更します。|
|`FadeIn`|IDに対応した音を一定時間かけてフェードインさせます。|
|`FadeOut`|IDに対応した音を一定時間かけてフェードアウトさせます。|
|`Fade`|IDに対応した音を一定時間かけて変更します。|
|`GetIsPlaybackSpeedEnabled`|IDに対応した音の再生速度を変更するかを取得します。|
|`SetIsPlaybackSpeedEnabled`|IDに対応した音の再生速度を変更するかを設定します。|
|`GetPlaybackSpeed`|IDに対応した音の再生速度を取得します。|
|`SetPlaybackSpeed`|IDに対応した音の再生速度を設定します。|
|`GetPanningPosition`|IDに対応した音のパン位置を取得します。|
|`SetPanningPosition`|IDに対応した音のパン位置を設定します。|
|`GetPlaybackPosition`|IDに対応した音の再生位置を取得します。|
|`SetPlaybackPosition`|IDに対応した音の再生位置を設定します。|
|`GetSpectrumData`|IDに対応した音のスペクトル情報を取得します。|

### プロパティ一覧

このクラスにプロパティはありません。

## Sound クラス ・ SoundMixer クラスのサンプル

### 効果音の再生
[!code-csharp[Main](SE.cs)]

### BGMの再生
[!code-csharp[Main](BGM.cs)]

### BGMのループ再生
[!code-csharp[Main](LoopingBGM.cs)]